## Хостинг NodeJS приложения на [Scalingo]()

### Начало работы 

* Создайте аккаунт [Scalingo](https://scalingo.com/users/signup). Регистрация бесплатна. Доступно 30 дней бесплатного использования хостинга. 

* Убедитесь, что на вашем пк установлен git. 

* После завершения регистрации вам нужно будет настроить аутентификацию по ssh ключу. Для этого выполните следующие команды в git-bash: 
```
$ cd $HOME
$ mkdir .ssh
$ cd .ssh
$ ssh-keygen.exe
```
Когда вам будут предложены опции ввести имя файла и пароль, нажимайте Enter. 

* Выполните следующую команду: 
```
$ cat $HOME/.ssh/id_rsa.pub
```
* Чтобы убедиться, что все сделано правильно, выполните следующую команду: 
```
$ ssh.exe -T git@scalingo.com
```
* В консоли должно отобразиться сообщение: 
```
You've successfully authenticated on Scalingo, but there is no shell access
```


### Загрузка приложения на хостинг 

* После активации аккаунта вы будете перенаправлены на страницу управления приложениями. Кликните по кнопке 'create new app'. 
* В открывшемся окне введите имя вашего приложения. 
* Выберите аддон Scalingo MySQL для создания MySQL базы данных для приложения. Кликните по кнопке 'next' чтобы перейти к завершающему шагу загрузки приложения на хостинг. 

* Перейдите в директорию с вашим приоложением. 

* Создайте файл package.json с зависимостями, необходимыми для работы приложения. 
* Запустите git bash (кликните правой кнопкой мыши и выберите пункт меню git bash here). 

* Выполните команду: 
```
$ git remote add scalingo git@scalingo.com:app_name.git
```
где app_name - имя вашего приложения. 

* Выполните команду: 
```
$ git push scalingo master 
``` 

* Ваше приложение будет доступно по ссылке  https://app_name.scalingo.io, где app_name - имя вашего приложения.  


### Подключение MySQL  

* Установите [инструменты Scalingo для командной строки](http://doc.scalingo.com/app/command-line-tool.html). В терминале станет доступна команда scalingo. 
* Выполните в терминале команду: 
```
$ scalingo -a app_name env | grep MYSQL

```
где app_name - имя вашего приложения. 

* В консоль будут выведены данные для подключения к базе данных приложения в формате: 

mysql://username:password@host:port/db 

* Еще один способ получить данные для подключения к бд - через страницу управления вашим приложением. Для этого перейдите на эту страницу: 
![](../images/s_001.jpg)
* Выберите пункт меню Environment: 
![](../images/s_002.jpg) 
* Данные для подключения к дб находятся в окне Environment Variables. 
![](../images/s_003.jpg) 


* Используйте полученные данные для подключения к базе данных в приложении. 

Например, данные для подключения к бд:
mysql://mydemoapp_6072:bD-z_8YYNhx5IHGUw_Gy@mydemoapp-6072.mysql.dbs.appsdeck.eu:30174/mydemoapp_6072

Подключение к бд с помощью node-mysql: 
```
mysql.createConnection({
    host: 'mydemoapp-6072.mysql.dbs.appsdeck.eu',
    port: 30174,
    user: 'mydemoapp_6072',
    password: 'bD-z_8YYNhx5IHGUw_Gy',
    database: 'mydemoapp_6072'
})
``` 

* Для импорта данных в бд выполните следующую команду в терминале: 
```
scalingo -a example-app db-tunnel DATABASE_URL
```
* В результате выполнения команды база данных будет доступна на локальном сервере. В консоль будет выведено сообщение, в котором указано, какой порт следует использовать для подключения к бд: 
```
Building tunnel to <dbhost>:<dbport>
You can access your database on '127.0.0.1:<localport>'
```

* Инструкция по импорту данных в бд [здесь](../importing_data.md). 

